Option Explicit

' get initials from All Therapists sheet and put them in the initials boxes
' in the ExperimentalAS sheet

Public Sub getInitials()
    ' declare variables
    Dim initialsBoxes As Variant
    Dim counter As Integer
    Dim i As Integer
    Dim cell As Range
    
    ' initialize counter and array
    ' if cell in named range from All Therapists Sheet contains initials, add to array
    counter = 0
    ReDim initials(0)
    For Each cell In Sheets("All Therapists").Range("therapistsInitials")
        If cell.Value <> "-" And Not IsEmpty(cell) Then
            initials(counter) = cell.Value
            counter = counter + 1
            ReDim Preserve initials(counter)
        End If
    Next cell
    
    ' initialize counter for initials array
    ' loop through named range in ExperimentalAS and add initials to correct cells
    ' until initials array ends
    i = 0
    For Each cell In Sheets("ExperimentalAS").Range("therapistInitialsBox")
        If i < UBound(initials) Then
            cell.Value = initials(i)
        End If
        i = i + 1
    Next cell
End Sub

' match initials from therapist schedule to initials in All Therapists sheet and grab
' room numbers for that therapist

Public Sub getRooms()
    Dim cell As Range
    Dim newCell As Range
    Dim rng As Range
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    
    ' set initial cell value to first therapist initials box
    Set cell = Sheets("ExperimentalAS").Range("$O$1")
    ' set newCell to same value
    Set newCell = cell
    
    ' set counter for newCell row offset
    j = 3
    
    ' for each cell in All Therapists initials column, if value of cell (rng)
    ' matches value of newCell, grab the room numbers and put them in the correct
    ' schedule
    For Each rng In Sheets("All Therapists").Range("therapistsInitials")
        If newCell.Value = rng.Value Then
           ' set counter (k) for All Therapists initials cell column numbers
           For k = 4 To 21
            If Not IsEmpty(rng.Offset(0, k).Value) Then
                newCell.Offset(j, -14).Value = rng.Offset(0, k).Value
                j = j + 1
            End If
           Next k
          ' go to the next therapist initials box in schedule
          Set newCell = newCell.Offset(33, 0)
        End If
       ' reset counter for newCell row offset
       j = 3
    Next rng

End Sub

Public Sub getSchedules()
    ' declare variables
    Dim therapistRoom As Range
    Dim room3W As Range
    Dim room3P As Range
    Dim room8P As Range
    Dim allSchedRooms As Range
    Dim rooms3WSched As Range
    Dim rooms3PSched As Range
    Dim rooms8PSched As Range
    
    ' set variables
    Set allSchedRooms = Sheets("ExperimentalAS").Range("RoomsAllSchedules")
    Set rooms3WSched = Sheets("3W Schedule").Range("Rooms3WSchedule")
    Set rooms3PSched = Sheets("3P Schedule").Range("Rooms3PSchedule")
    Set rooms8PSched = Sheets("8P Schedule").Range("Rooms8PSchedule")
    
    ' Grab rooms from 3W Schedule
    For Each therapistRoom In allSchedRooms
        For Each room3W In rooms3WSched
            If IsEmpty(therapistRoom.Value) Or therapistRoom.Value > 89 Then
                Exit For
            End If
            
            If therapistRoom.Value = room3W.Value Then
                Range(room3W.Offset(0, 1), room3W.Offset(0, 22)).Copy
                Range(therapistRoom.Offset(0, 4), therapistRoom.Offset(0, 24)).PasteSpecial xlPasteValues
                Exit For
            End If
        Next room3W
    Next therapistRoom
    
    ' Grab rooms from 8P Schedule
    For Each therapistRoom In allSchedRooms
        For Each room8P In rooms8PSched
            If therapistRoom.Value = room8P.Value Then
                Range(room8P.Offset(0, 1), room8P.Offset(0, 22)).Copy
                Range(therapistRoom.Offset(0, 4), therapistRoom.Offset(0, 24)).PasteSpecial xlPasteValues
                Exit For
            End If
        Next room8P
    Next therapistRoom
    
    ' turn cut copy mode off
    Application.CutCopyMode = False
    

End Sub
